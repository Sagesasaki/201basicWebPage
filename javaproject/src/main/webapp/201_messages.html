<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Chat Messages - SkillSwap</title>
	<!-- Include Tailwind CSS from CDN -->
	<link href="https://cdn.tailwindcss.com" rel="stylesheet">
	<style>
		/* Page and container setup */
		.space-theme-bg {
			background-color: #0a0b1a;
			/* Deep Space Blue */
		}

		.space-theme-accent {
			color: #7f00ff;
			/* Neon Purple for that video game feel */
		}

		.space-theme-accent-bg {
			background-color: #7f00ff;
			/* Neon Purple background for buttons */
		}

		.space-theme-text {
			color: #ccd6f6;
			/* Soft light blue for text */
		}

		/* Hover effect for buttons */
		.btn:hover {
			background-color: #8f29ff;
			/* Slightly lighter purple on hover */
			transform: scale(1.05);
			/* Slightly larger on hover */
		}

		.btn:active {
			background-color: #5701a3;
			/* Darker purple when clicked */
			transform: scale(0.95);
			/* Slightly smaller when clicked */
		}

		/* Card hover effect */
		.card:hover {
			background-color: #2a2f45;
			/* Slightly lighter background on hover */
			transform: translateY(-5px);
			/* Raise card */
			transition: background-color 0.3s ease, transform 0.3s ease;
		}

		/* Profile icon link */
		.profile-link:hover {
			background-color: #7f00ff;
			/* Slightly lighter background on hover */
			transition: background-color 0.3s ease;
		}

		/* Fade-in effect on page load */
		body {
			animation: fadeIn 1s ease-in;
		}

		@keyframes fadeIn {
			from {
				opacity: 0;
			}

			to {
				opacity: 1;
			}
		}

		html,
		body {
			height:90%;
			margin: 0;
			font-family: 'Avenir', Helvetica, Arial, sans-serif;
			color: white;
			/* Set text color to white */
		}

		body {
			background-color: #111827;
			/* Dark background for the whole page */
		}

		/* Chat layout styling */
		.chat-container {
			display: flex;
			height: 100%;
		}

		/* Chat list */
		.chat-list {
			width: 20%;
			background: #1F2937;
			padding: 1rem;
			overflow-y: auto;
		}

		/* Chat items */
		.chat-item {
			color: #9CA3AF;
			padding: 0.75rem 1rem;
			cursor: pointer;
			border-radius: 0.5rem;
			list-style-type: none;
			/* Remove bullet points */
		}

		.chat-item:hover {
			background: #374151;
		}

		/* Message area */
		.message-area {
			flex-grow: 1;
			background: #111827;
			display: flex;
			flex-direction: column;
		}

		.message-display {
			flex-grow: 1;
			overflow-y: auto;
			padding: 1rem;
		}

		/* Messages */
		.message {
			margin: 0.5rem 0;
			padding: 0.75rem 1rem;
			border-radius: 1rem;
			max-width: 60%;
			word-wrap: break-word;
		}

		.message-sent {
			background: #4F46E5;
			/* Sender message color */
			margin-left: auto;
			color: white;
			/* Ensure sent message text is also white for consistency */
		}

		.message-received {
			background: #374151;
			/* Receiver message color */
			margin-right: auto;
			color: white;
			/* Change text color to white */
		}


		/* Input area */
		.input-area {
			padding: 1rem;
			background: #1F2937;
			border-top: 2px solid #000;
		}

		.input-area input {
			flex-grow: 1;
			padding: 0.75rem 1rem;
			margin-right: 0.5rem;
			border-radius: 9999px;
			border: none;
			background: #374151;
			color: #D1D5DB;
			outline: none;
			max-width: 75%;
			/* Updated max-width to 75% */
		}

		.input-area button {
			padding: 0.75rem 1.5rem;
			background: #4F46E5;
			/* Button color */
			color: white;
			border: none;
			border-radius: 9999px;
			cursor: pointer;
		}
	</style>
</head>

<body>

	<header id="mainHeader" class="flex justify-between items-center p-4">
		<a href="201_explorePage.html"
			class="text-5xl space-theme-accent font-bold transition-transform hover:scale-110">SkillSwap</a>
		<div class="flex items-center space-x-4"> <!-- Added flex container with spacing -->

			<a href="201_profilePage.html"
				class="profile-link p-2 rounded-full hover:bg-purple-700 transition duration-300">
				<img src="https://via.placeholder.com/150" alt="Profile" class="w-8 h-8 rounded-full">
			</a>
			<form action="logoutUser" method="get">
				<button type="submit"
					class="profile-link p-2 rounded-full hover:bg-purple-700 transition duration-300">Logout</button>
			</form>
		</div>
	</header>
	<div class="chat-container">

		<!-- Chat list -->
		<div class="chat-list">
			<ul id="chatList">
				<!-- Chat list items will be dynamically populated here -->
			</ul>
		</div>

		<!-- Chat window -->
		<div class="message-area">
			<!-- Chat messages display -->
			<div id="messageArea" class="message-display">
				<!-- Messages will be dynamically populated here -->
			</div>
			<!-- Message input area -->
			<div class="input-area">
				<input id="messageInput" type="text" placeholder="Type a message..." class="w-full px-4 py-2" />
				<button onclick="sendMessage()" class="send-button">Send</button>
			</div>
		</div>
	</div>

	<script>
		// Sample data for users and messages
		let chats = [
			{id: 1, name: "Alice", messages: [{text: "How's it going?", owner: 'Alice'}]},
			{id: 2, name: "Bob", messages: [{text: "Are we still on for today?", owner: 'Bob'}]},
			{id: 3, name: "Charlie", messages: []}, // Add Charlie
			{id: 4, name: "David", messages: []},   // Add David
			{id: 5, name: "Eva", messages: []}       // Add Eva
		];
		let currentUser = "You";

		// Function to initialize the chat list
		function initChatList() {
			const chatList = document.getElementById('chatList');
			chats.forEach(chat => {
				let chatItem = document.createElement('li');
				chatItem.classList.add('chat-item');
				chatItem.textContent = chat.name;
				chatItem.onclick = function () {setActiveChat(chat.id);};
				chatList.appendChild(chatItem);
			});
		}

		// Function to set active chat
		function setActiveChat(chatId) {
			const chat = chats.find(c => c.id === chatId);
			document.getElementById('messageArea').innerHTML = '';
			chat.messages.forEach(message => {
				displayMessage(message.text, message.owner !== currentUser);
			});
		}

		// Function to display a message
		function displayMessage(text, isReceived) {
			const messageArea = document.getElementById('messageArea');
			let messageDiv = document.createElement('div');
			let messageContent = document.createElement('div');
			messageContent.textContent = text;

			if (isReceived) {
				messageDiv.classList.add('message', 'message-received');
			} else {
				messageDiv.classList.add('message', 'message-sent');
			}

			messageDiv.appendChild(messageContent);
			messageArea.appendChild(messageDiv);
			messageArea.scrollTop = messageArea.scrollHeight; // Auto-scroll to the latest message
		}

		// Function to send a new message
		function sendMessage() {
			const input = document.getElementById('messageInput');
			const text = input.value.trim();
			if (text) {
				displayMessage(text, false);
				input.value = ''; // Clear the input after sending
			}
		}

		// Initialize the chat list on load
		window.onload = () => {
			console.log("running");
			fetch('checkLoginStatus')
				.then(response => response.json())
				.then(data => {
					console.log(data);
					if (!data.isLoggedIn) {
						window.location.href = '201_login.html?error=Please log in to continue';
					}
				})
				.catch(error => {
					console.error('Error checking login status:', error);
				});
			const header = document.getElementById('mainHeader');
			const chatContainer = document.querySelector('.chat-container');
			const headerHeight = header.clientHeight;
			chatContainer.style.height = `calc(100vh - ${headerHeight}px)`;

			initChatList();
		};
	</script>
	<script src="https://cdn.tailwindcss.com"></script>


</body>

</html>